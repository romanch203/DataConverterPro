<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation - File Converter API</title>
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-dark.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/custom.css') }}" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <i class="fas fa-file-csv me-2"></i>
                File Converter API
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="{{ url_for('index') }}">
                    <i class="fas fa-home me-1"></i>
                    Home
                </a>
            </div>
        </div>
    </nav>

    <div class="container my-5">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-3">
                <div class="card position-sticky" style="top: 20px;">
                    <div class="card-header">
                        <h6 class="card-title mb-0">Navigation</h6>
                    </div>
                    <div class="card-body p-0">
                        <nav class="nav flex-column">
                            <a class="nav-link" href="#overview">Overview</a>
                            <a class="nav-link" href="#authentication">Authentication</a>
                            <a class="nav-link" href="#endpoints">Endpoints</a>
                            <a class="nav-link" href="#single-convert">Single File Conversion</a>
                            <a class="nav-link" href="#batch-convert">Batch Conversion</a>
                            <a class="nav-link" href="#download">Download Results</a>
                            <a class="nav-link" href="#status">API Status</a>
                            <a class="nav-link" href="#examples">Examples</a>
                            <a class="nav-link" href="#errors">Error Handling</a>
                        </nav>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-lg-9">
                <!-- Overview -->
                <section id="overview" class="mb-5">
                    <h1 class="display-6 fw-bold mb-4">API Documentation</h1>
                    <p class="lead">
                        The File Converter API provides high-accuracy extraction of statistical data from documents and images,
                        converting them to CSV format. The API supports DOCX, PDF, and various image formats with advanced
                        OCR and table detection capabilities.
                    </p>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <i class="fas fa-link text-primary me-2"></i>
                                        Base URL
                                    </h6>
                                    <code class="text-info">https://your-domain.com/api</code>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title">
                                        <i class="fas fa-code text-success me-2"></i>
                                        Content Type
                                    </h6>
                                    <code class="text-info">multipart/form-data</code>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Supported Formats:</strong> DOCX, PDF, PNG, JPG, JPEG, BMP, TIFF
                        <br>
                        <strong>File Size Limit:</strong> 50MB per file
                        <br>
                        <strong>Processing:</strong> Asynchronous with immediate response
                    </div>
                </section>

                <!-- Authentication -->
                <section id="authentication" class="mb-5">
                    <h2 class="h3 mb-3">Authentication</h2>
                    <p>
                        Currently, the API does not require authentication. All endpoints are publicly accessible.
                        For production use, consider implementing API keys or OAuth 2.0.
                    </p>
                </section>

                <!-- Endpoints -->
                <section id="endpoints" class="mb-5">
                    <h2 class="h3 mb-3">API Endpoints</h2>
                    
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Method</th>
                                    <th>Endpoint</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><span class="badge bg-success">POST</span></td>
                                    <td><code>/api/convert</code></td>
                                    <td>Convert a single file to CSV</td>
                                </tr>
                                <tr>
                                    <td><span class="badge bg-success">POST</span></td>
                                    <td><code>/api/batch-convert</code></td>
                                    <td>Convert multiple files in batch</td>
                                </tr>
                                <tr>
                                    <td><span class="badge bg-primary">GET</span></td>
                                    <td><code>/api/download/{file_id}</code></td>
                                    <td>Download converted CSV file</td>
                                </tr>
                                <tr>
                                    <td><span class="badge bg-primary">GET</span></td>
                                    <td><code>/api/status</code></td>
                                    <td>Check API health status</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Single File Conversion -->
                <section id="single-convert" class="mb-5">
                    <h2 class="h3 mb-3">Single File Conversion</h2>
                    <p>Convert a single document or image file to CSV format.</p>

                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="mb-0">Request</h6>
                        </div>
                        <div class="card-body">
                            <p><strong>Endpoint:</strong> <code>POST /api/convert</code></p>
                            <p><strong>Content-Type:</strong> <code>multipart/form-data</code></p>
                            
                            <h6>Parameters:</h6>
                            <ul>
                                <li><code>file</code> (required): The file to be converted</li>
                            </ul>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="mb-0">Example Request</h6>
                        </div>
                        <div class="card-body">
                            <pre><code class="language-bash">curl -X POST \
  https://your-domain.com/api/convert \
  -H 'Content-Type: multipart/form-data' \
  -F 'file=@/path/to/your/document.pdf'</code></pre>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">Example Response</h6>
                        </div>
                        <div class="card-body">
                            <pre><code class="language-json">{
  "success": true,
  "message": "File converted successfully",
  "file_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "original_filename": "document.pdf",
  "download_url": "/api/download/a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "conversion_stats": {
    "tables_found": 3,
    "total_rows": 45,
    "total_columns": 7,
    "accuracy_score": 0.95,
    "processing_time": 2.34
  },
  "quality_metrics": {
    "accuracy_score": 0.95,
    "completeness": 0.98,
    "total_cells": 315,
    "empty_cells": 6
  },
  "warnings": []
}</code></pre>
                        </div>
                    </div>
                </section>

                <!-- Batch Conversion -->
                <section id="batch-convert" class="mb-5">
                    <h2 class="h3 mb-3">Batch Conversion</h2>
                    <p>Convert multiple files simultaneously.</p>

                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="mb-0">Request</h6>
                        </div>
                        <div class="card-body">
                            <p><strong>Endpoint:</strong> <code>POST /api/batch-convert</code></p>
                            <p><strong>Content-Type:</strong> <code>multipart/form-data</code></p>
                            
                            <h6>Parameters:</h6>
                            <ul>
                                <li><code>files</code> (required): Array of files to be converted</li>
                            </ul>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">Example Response</h6>
                        </div>
                        <div class="card-body">
                            <pre><code class="language-json">{
  "success": true,
  "batch_id": "batch_a1b2c3d4-e5f6-7890",
  "total_files": 3,
  "successful_conversions": 2,
  "failed_conversions": 1,
  "results": [
    {
      "filename": "data1.pdf",
      "success": true,
      "file_id": "file1_id",
      "download_url": "/api/download/file1_id",
      "stats": {
        "tables_found": 2,
        "total_rows": 20
      }
    },
    {
      "filename": "data2.docx",
      "success": true,
      "file_id": "file2_id",
      "download_url": "/api/download/file2_id",
      "stats": {
        "tables_found": 1,
        "total_rows": 15
      }
    },
    {
      "filename": "corrupt.pdf",
      "success": false,
      "error": "Data extraction failed"
    }
  ]
}</code></pre>
                        </div>
                    </div>
                </section>

                <!-- Download -->
                <section id="download" class="mb-5">
                    <h2 class="h3 mb-3">Download Converted Files</h2>
                    <p>Download the converted CSV file using the file ID from the conversion response.</p>

                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="mb-0">Request</h6>
                        </div>
                        <div class="card-body">
                            <p><strong>Endpoint:</strong> <code>GET /api/download/{file_id}</code></p>
                            <p><strong>Response:</strong> CSV file download</p>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">Example Request</h6>
                        </div>
                        <div class="card-body">
                            <pre><code class="language-bash">curl -X GET \
  https://your-domain.com/api/download/a1b2c3d4-e5f6-7890-abcd-ef1234567890 \
  -o converted_data.csv</code></pre>
                        </div>
                    </div>
                </section>

                <!-- API Status -->
                <section id="status" class="mb-5">
                    <h2 class="h3 mb-3">API Status</h2>
                    <p>Check the health and status of the API service.</p>

                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">Example Response</h6>
                        </div>
                        <div class="card-body">
                            <pre><code class="language-json">{
  "status": "operational",
  "version": "1.0.0",
  "supported_formats": [".docx", ".pdf", ".png", ".jpg", ".jpeg", ".bmp", ".tiff"],
  "max_file_size": "50MB",
  "features": [
    "table_extraction",
    "ocr_processing",
    "batch_conversion",
    "quality_metrics",
    "data_validation"
  ]
}</code></pre>
                        </div>
                    </div>
                </section>

                <!-- Examples -->
                <section id="examples" class="mb-5">
                    <h2 class="h3 mb-3">Code Examples</h2>

                    <div class="row">
                        <div class="col-12 mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">Python Example</h6>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-python">import requests

# Single file conversion
def convert_file(file_path):
    url = "https://your-domain.com/api/convert"
    
    with open(file_path, 'rb') as file:
        files = {'file': file}
        response = requests.post(url, files=files)
        
    if response.status_code == 200:
        result = response.json()
        if result['success']:
            # Download the converted CSV
            download_url = f"https://your-domain.com{result['download_url']}"
            csv_response = requests.get(download_url)
            
            with open('converted_data.csv', 'wb') as csv_file:
                csv_file.write(csv_response.content)
                
            print(f"Conversion successful: {result['conversion_stats']}")
        else:
            print(f"Conversion failed: {result['message']}")
    else:
        print(f"Request failed: {response.status_code}")

# Usage
convert_file("document.pdf")</code></pre>
                                </div>
                            </div>
                        </div>

                        <div class="col-12 mb-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">JavaScript Example</h6>
                                </div>
                                <div class="card-body">
                                    <pre><code class="language-javascript">async function convertFile(file) {
    const formData = new FormData();
    formData.append('file', file);
    
    try {
        const response = await fetch('/api/convert', {
            method: 'POST',
            body: formData
        });
        
        const result = await response.json();
        
        if (result.success) {
            console.log('Conversion successful:', result.conversion_stats);
            
            // Download the converted file
            const downloadResponse = await fetch(result.download_url);
            const blob = await downloadResponse.blob();
            
            // Create download link
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'converted_data.csv';
            a.click();
            
            window.URL.revokeObjectURL(url);
        } else {
            console.error('Conversion failed:', result.message);
        }
    } catch (error) {
        console.error('Error:', error);
    }
}

// Usage with file input
document.getElementById('fileInput').addEventListener('change', (event) => {
    const file = event.target.files[0];
    if (file) {
        convertFile(file);
    }
});</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Error Handling -->
                <section id="errors" class="mb-5">
                    <h2 class="h3 mb-3">Error Handling</h2>
                    <p>The API uses standard HTTP status codes and returns detailed error information.</p>

                    <div class="table-responsive mb-3">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Status Code</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>200</td>
                                    <td>Success</td>
                                </tr>
                                <tr>
                                    <td>400</td>
                                    <td>Bad Request (invalid file, missing parameters)</td>
                                </tr>
                                <tr>
                                    <td>404</td>
                                    <td>Not Found (file not found for download)</td>
                                </tr>
                                <tr>
                                    <td>413</td>
                                    <td>Payload Too Large (file size exceeds limit)</td>
                                </tr>
                                <tr>
                                    <td>500</td>
                                    <td>Internal Server Error</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h6 class="mb-0">Error Response Format</h6>
                        </div>
                        <div class="card-body">
                            <pre><code class="language-json">{
  "success": false,
  "error": "Invalid file",
  "message": "Unsupported file format. Allowed formats: .docx, .pdf, .png, .jpg, .jpeg, .bmp, .tiff",
  "details": {
    "error_type": "ValidationError",
    "file_path": "/uploads/invalid_file.txt"
  }
}</code></pre>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark py-4 mt-5">
        <div class="container text-center">
            <p class="mb-0 text-muted">
                File Converter API Documentation &copy; 2025
            </p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
